{"ast":null,"code":"import request from \"../../utils/request\";\nimport { ElMessage } from \"element-plus\";\nlet searchId;\nlet userEmail;\nexport default {\n  name: \"Search\",\n\n  data() {\n    return {\n      tableData: [],\n      total: 0,\n      pageSize: 5,\n      currentPage: 1,\n      dialogFormVisibleForDelete: false,\n      dialogFormVisibleForClear: false\n    };\n  },\n\n  created() {\n    //初始时加载表格数据\n    this.loadData();\n  },\n\n  methods: {\n    //当前页改变\n    handleCurrentChange() {\n      this.loadData();\n    },\n\n    //清空历史记录\n    clear() {\n      this.dialogFormVisibleForClear = true;\n    },\n\n    //确认清空\n    conformClear() {\n      request.post(\"/search/clearUserSearch\", userEmail).then(res => {\n        this.loadData();\n        this.dialogFormVisibleForClear = false;\n        ElMessage({\n          type: 'success',\n          message: '清空成功'\n        });\n      });\n    },\n\n    //删除搜索记录\n    delete(id) {\n      searchId = id;\n      this.dialogFormVisibleForDelete = true;\n    },\n\n    //确认删除\n    conformDelete() {\n      request.post(\"/search/deleteOneSearchById\", searchId).then(res => {\n        this.loadData();\n        this.dialogFormVisibleForDelete = false;\n        ElMessage({\n          type: 'success',\n          message: '删除成功'\n        });\n      });\n    },\n\n    //加载表格数据\n    loadData() {\n      let email = sessionStorage.getItem(\"userEmail\");\n      let reg = new RegExp('\"', \"g\");\n      userEmail = email.replace(reg, \"\"); //正则表达式，将字符串两端的双引号去掉\n\n      request.get(\"/search/getAllSearchByUserEmail\", {\n        params: {\n          userEmail: userEmail,\n          currentPage: this.currentPage,\n          pageSize: this.pageSize\n        }\n      }).then(res => {\n        this.total = res.data.total;\n        this.tableData = res.data.records;\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"AA8CA,OAAOA,OAAP,MAAoB,qBAApB;AACA,SAAQC,SAAR,QAAwB,cAAxB;AACA,IAAIC,QAAJ;AACA,IAAIC,SAAJ;AAEA,eAAe;EACbC,IAAI,EAAE,QADO;;EAEbC,IAAI,GAAG;IACL,OAAO;MACLC,SAAS,EAAE,EADN;MAILC,KAAK,EAAE,CAJF;MAKLC,QAAQ,EAAE,CALL;MAMLC,WAAW,EAAE,CANR;MAOLC,0BAA0B,EAAE,KAPvB;MAQLC,yBAAyB,EAAE;IARtB,CAAP;EAUD,CAbY;;EAcbC,OAAO,GAAG;IACR;IACA,KAAKC,QAAL;EACD,CAjBY;;EAkBbC,OAAO,EAAE;IACP;IACAC,mBAAmB,GAAG;MACpB,KAAKF,QAAL;IACD,CAJM;;IAKP;IACAG,KAAK,GAAG;MACN,KAAKL,yBAAL,GAAiC,IAAjC;IACD,CARM;;IASP;IACAM,YAAY,GAAG;MACbjB,OAAO,CAACkB,IAAR,CAAa,yBAAb,EAAuCf,SAAvC,EAAkDgB,IAAlD,CAAuDC,GAAE,IAAI;QAC3D,KAAKP,QAAL;QACA,KAAKF,yBAAL,GAAiC,KAAjC;QACAV,SAAS,CAAC;UACRoB,IAAI,EAAE,SADE;UAERC,OAAO,EAAE;QAFD,CAAD,CAAT;MAID,CAPD;IAQD,CAnBM;;IAoBP;IACAC,MAAM,CAACC,EAAD,EAAK;MACTtB,QAAO,GAAIsB,EAAX;MACA,KAAKd,0BAAL,GAAkC,IAAlC;IACD,CAxBM;;IAyBP;IACAe,aAAa,GAAG;MACdzB,OAAO,CAACkB,IAAR,CAAa,6BAAb,EAA2ChB,QAA3C,EAAqDiB,IAArD,CAA0DC,GAAE,IAAI;QAC9D,KAAKP,QAAL;QACA,KAAKH,0BAAL,GAAkC,KAAlC;QACAT,SAAS,CAAC;UACRoB,IAAI,EAAE,SADE;UAERC,OAAO,EAAE;QAFD,CAAD,CAAT;MAID,CAPD;IAQD,CAnCM;;IAoCP;IACAT,QAAQ,GAAG;MACT,IAAIa,KAAI,GAAIC,cAAc,CAACC,OAAf,CAAuB,WAAvB,CAAZ;MACA,IAAIC,GAAE,GAAI,IAAIC,MAAJ,CAAW,GAAX,EAAgB,GAAhB,CAAV;MACA3B,SAAQ,GAAIuB,KAAK,CAACK,OAAN,CAAcF,GAAd,EAAmB,EAAnB,CAAZ,CAHS,CAG8B;;MACvC7B,OAAO,CAACgC,GAAR,CAAY,iCAAZ,EAA8C;QAC5CC,MAAM,EAAE;UACN9B,SAAS,EAAEA,SADL;UAENM,WAAW,EAAE,KAAKA,WAFZ;UAGND,QAAQ,EAAE,KAAKA;QAHT;MADoC,CAA9C,EAMGW,IANH,CAMQC,GAAE,IAAI;QACZ,KAAKb,KAAL,GAAaa,GAAG,CAACf,IAAJ,CAASE,KAAtB;QACA,KAAKD,SAAL,GAAiBc,GAAG,CAACf,IAAJ,CAAS6B,OAA1B;MACD,CATD;IAUF;;EAnDO;AAlBI,CAAf","names":["request","ElMessage","searchId","userEmail","name","data","tableData","total","pageSize","currentPage","dialogFormVisibleForDelete","dialogFormVisibleForClear","created","loadData","methods","handleCurrentChange","clear","conformClear","post","then","res","type","message","delete","id","conformDelete","email","sessionStorage","getItem","reg","RegExp","replace","get","params","records"],"sourceRoot":"","sources":["/Users/wangjin/Desktop/newspublisher/Vue/src/views/user/Search.vue"],"sourcesContent":["<template>\n  <el-button type=\"primary\" class=\"el1\" @click=\"clear()\">清空搜索记录</el-button>\n  <div class=\"dF\">\n    <el-table :data=\"tableData\" border class=\"el2\">\n      <el-table-column prop=\"content\" label=\"搜索内容\" width=\"\" align=\"center\" />\n      <el-table-column label=\"操作\" width=\"\" align=\"center\" key=\"slot\">\n        <!--此处使用了插槽，来实现获得某行的对象-->\n        <template #default=\"scope\" >\n          <el-button type=\"text\" size=\"big\" @click=\"this.delete(scope.row.id)\">删除</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    <!--分页组件-->\n    <el-pagination\n        background\n        layout=\"total, prev, pager, next\"\n        :total=\"total\"\n        :page-size=\"pageSize\"\n        v-model:currentPage=\"currentPage\"\n        @current-change=\"handleCurrentChange\"\n        class=\"el3\">\n    </el-pagination>\n  </div>\n  <!--删除搜索记录弹窗-->\n  <el-dialog v-model=\"dialogFormVisibleForDelete\" title=\"删除搜索记录\">\n    <span>是否确认删除该搜索记录？</span>\n    <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button @click=\"dialogFormVisibleForDelete = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"conformDelete()\">确定</el-button>\n      </span>\n    </template>\n  </el-dialog>\n  <!--清空搜索记录弹窗-->\n  <el-dialog v-model=\"dialogFormVisibleForClear\" title=\"清空搜索记录\">\n    <span>是否确认清空搜索记录？</span>\n    <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button @click=\"dialogFormVisibleForClear = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"conformClear()\">确定</el-button>\n      </span>\n    </template>\n  </el-dialog>\n</template>\n\n<script>\nimport request from \"../../utils/request\";\nimport {ElMessage} from \"element-plus\";\nlet searchId;\nlet userEmail;\n\nexport default {\n  name: \"Search\",\n  data() {\n    return {\n      tableData: [\n\n      ],\n      total: 0,\n      pageSize: 5,\n      currentPage: 1,\n      dialogFormVisibleForDelete: false,\n      dialogFormVisibleForClear: false\n    }\n  },\n  created() {\n    //初始时加载表格数据\n    this.loadData()\n  },\n  methods: {\n    //当前页改变\n    handleCurrentChange() {\n      this.loadData()\n    },\n    //清空历史记录\n    clear() {\n      this.dialogFormVisibleForClear = true\n    },\n    //确认清空\n    conformClear() {\n      request.post(\"/search/clearUserSearch\",userEmail).then(res =>{\n        this.loadData()\n        this.dialogFormVisibleForClear = false\n        ElMessage({\n          type: 'success',\n          message: '清空成功'\n        })\n      })\n    },\n    //删除搜索记录\n    delete(id) {\n      searchId = id\n      this.dialogFormVisibleForDelete = true\n    },\n    //确认删除\n    conformDelete() {\n      request.post(\"/search/deleteOneSearchById\",searchId).then(res =>{\n        this.loadData()\n        this.dialogFormVisibleForDelete = false\n        ElMessage({\n          type: 'success',\n          message: '删除成功'\n        })\n      })\n    },\n    //加载表格数据\n    loadData() {\n      let email = sessionStorage.getItem(\"userEmail\")\n      let reg = new RegExp('\"', \"g\");\n      userEmail = email.replace(reg, \"\");    //正则表达式，将字符串两端的双引号去掉\n      request.get(\"/search/getAllSearchByUserEmail\",{\n        params: {\n          userEmail: userEmail,\n          currentPage: this.currentPage,\n          pageSize: this.pageSize\n        }\n      }).then(res =>{\n        this.total = res.data.total\n        this.tableData = res.data.records\n      })\n    }\n  },\n}\n</script>\n\n<style scoped>\n.el1{\n  position: absolute;left: 5%;margin-top: 50px;\n}\n.dF{\n  width: 90%;position: absolute;left: 5%;right: 5%;margin-top: 100px;\n}\n.el2{\n  width: 100%;\n}\n.el3{\n  margin-top: 15px;\n}\n</style>"]},"metadata":{},"sourceType":"module"}