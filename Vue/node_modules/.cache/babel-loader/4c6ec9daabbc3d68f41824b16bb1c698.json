{"ast":null,"code":"import User from \"@element-plus/icons/lib/User\";\nimport Message from \"@element-plus/icons/lib/Message\";\nimport Clock from \"@element-plus/icons/lib/Clock\";\nimport Male from \"@element-plus/icons/lib/Male\";\nimport Location from \"@element-plus/icons/lib/Location\";\nimport $ from '../../assets/js/jquery-3.6.0';\nimport request from \"../../utils/request\";\nimport moment from \"moment\";\nimport { ElMessage } from \"element-plus\";\nlet petname;\nlet sex;\nlet birthday;\nlet area;\nlet mail;\nlet role;\nexport default {\n  name: \"SelfInfo\",\n  components: {\n    User,\n    Location,\n    Message,\n    Clock,\n    Male\n  },\n\n  created() {\n    this.loadData();\n  },\n\n  data() {\n    return {\n      dialogFormVisibleForEdit: false,\n      ruleForm: {\n        email: '',\n        petname: '',\n        sex: '',\n        birthday: '',\n        area: '',\n        role: 0\n      },\n      rules: {\n        petname: [{\n          required: true,\n          message: '请输入昵称',\n          trigger: 'blur'\n        }],\n        sex: [{\n          required: true,\n          message: '请输入性别',\n          trigger: 'change'\n        }],\n        birthday: [{\n          type: 'date',\n          required: true,\n          message: '请选择生日',\n          trigger: 'change'\n        }],\n        area: [{\n          required: true,\n          message: '请选择省份',\n          trigger: 'change'\n        }]\n      }\n    };\n  },\n\n  methods: {\n    //加载数据\n    loadData() {\n      let userEmail = sessionStorage.getItem(\"userEmail\"); //从session中取出\n\n      let reg = new RegExp('\"', \"g\");\n      let email = userEmail.replace(reg, \"\"); //正则表达式，将字符串两端的双引号去掉\n\n      request.post(\"/user/get\", email).then(res => {\n        petname = res.data.petname;\n        sex = res.data.sex;\n        birthday = moment(res.data.birthday).format(\"YYYY-MM-DD\");\n        area = res.data.area;\n        mail = res.data.email;\n        role = res.data.role;\n        $('#sex').html(res.data.sex);\n        $('#name').html(res.data.petname);\n        $('#birthday').html(birthday);\n        $('#area').html(res.data.area);\n        $('#email').html(res.data.email);\n      });\n    },\n\n    //修改\n    edit() {\n      this.ruleForm.email = mail;\n      this.ruleForm.petname = petname;\n      this.ruleForm.sex = sex;\n      this.ruleForm.area = area;\n      this.ruleForm.birthday = birthday;\n      this.ruleForm.role = role;\n      this.dialogFormVisibleForEdit = true;\n    },\n\n    //提交表单\n    submitForm(formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          //如果表单不空\n          request.post(\"/user/editUser\", this.ruleForm).then(res => {\n            ElMessage({\n              type: 'success',\n              message: '修改成功'\n            });\n            this.loadData();\n            this.dialogFormVisibleForEdit = false;\n          });\n        } else {\n          //如果表单为空\n          return false;\n        }\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAoJA,OAAOA,IAAP,MAAiB,8BAAjB;AACA,OAAOC,OAAP,MAAoB,iCAApB;AACA,OAAOC,KAAP,MAAkB,+BAAlB;AACA,OAAOC,IAAP,MAAiB,8BAAjB;AACA,OAAOC,QAAP,MAAqB,kCAArB;AACA,OAAOC,CAAP,MAAc,8BAAd;AACA,OAAOC,OAAP,MAAoB,qBAApB;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,SAAQC,SAAR,QAAwB,cAAxB;AAEA,IAAIC,OAAJ;AACA,IAAIC,GAAJ;AACA,IAAIC,QAAJ;AACA,IAAIC,IAAJ;AACA,IAAIC,IAAJ;AACA,IAAIC,IAAJ;AAEA,eAAe;EACbC,IAAI,EAAE,UADO;EAEbC,UAAU,EAAE;IACVhB,IADU;IAEVI,QAFU;IAGVH,OAHU;IAIVC,KAJU;IAKVC;EALU,CAFC;;EASbc,OAAO,GAAG;IACR,KAAKC,QAAL;EACD,CAXY;;EAYbC,IAAI,GAAG;IACL,OAAO;MACLC,wBAAwB,EAAE,KADrB;MAELC,QAAQ,EAAE;QACRC,KAAK,EAAE,EADC;QAERb,OAAO,EAAE,EAFD;QAGRC,GAAG,EAAE,EAHG;QAIRC,QAAQ,EAAE,EAJF;QAKRC,IAAI,EAAE,EALE;QAMRE,IAAI,EAAE;MANE,CAFL;MAULS,KAAK,EAAE;QACLd,OAAO,EAAC,CACN;UACEe,QAAQ,EAAE,IADZ;UAEEC,OAAO,EAAE,OAFX;UAGEC,OAAO,EAAE;QAHX,CADM,CADH;QAQLhB,GAAG,EAAE,CACH;UACEc,QAAQ,EAAE,IADZ;UAEEC,OAAO,EAAE,OAFX;UAGEC,OAAO,EAAE;QAHX,CADG,CARA;QAeLf,QAAQ,EAAE,CACR;UACEgB,IAAI,EAAE,MADR;UAEEH,QAAQ,EAAE,IAFZ;UAGEC,OAAO,EAAE,OAHX;UAIEC,OAAO,EAAE;QAJX,CADQ,CAfL;QAuBLd,IAAI,EAAE,CACJ;UACEY,QAAQ,EAAE,IADZ;UAEEC,OAAO,EAAE,OAFX;UAGEC,OAAO,EAAE;QAHX,CADI;MAvBD;IAVF,CAAP;EA0CD,CAvDY;;EAwDbE,OAAO,EAAE;IACP;IACAV,QAAQ,GAAG;MACT,IAAIW,SAAQ,GAAIC,cAAc,CAACC,OAAf,CAAuB,WAAvB,CAAhB,CADS,CAC8C;;MACvD,IAAIC,GAAE,GAAI,IAAIC,MAAJ,CAAW,GAAX,EAAgB,GAAhB,CAAV;MACA,IAAIX,KAAI,GAAIO,SAAS,CAACK,OAAV,CAAkBF,GAAlB,EAAuB,EAAvB,CAAZ,CAHS,CAGkC;;MAC3C1B,OAAO,CAAC6B,IAAR,CAAa,WAAb,EAAyBb,KAAzB,EAAgCc,IAAhC,CAAqCC,GAAE,IAAI;QACzC5B,OAAM,GAAI4B,GAAG,CAAClB,IAAJ,CAASV,OAAnB;QACAC,GAAE,GAAI2B,GAAG,CAAClB,IAAJ,CAAST,GAAf;QACAC,QAAO,GAAIJ,MAAM,CAAC8B,GAAG,CAAClB,IAAJ,CAASR,QAAV,CAAN,CAA0B2B,MAA1B,CAAiC,YAAjC,CAAX;QACA1B,IAAG,GAAIyB,GAAG,CAAClB,IAAJ,CAASP,IAAhB;QACAC,IAAG,GAAIwB,GAAG,CAAClB,IAAJ,CAASG,KAAhB;QACAR,IAAG,GAAIuB,GAAG,CAAClB,IAAJ,CAASL,IAAhB;QACAT,CAAC,CAAC,MAAD,CAAD,CAAUkC,IAAV,CAAeF,GAAG,CAAClB,IAAJ,CAAST,GAAxB;QACAL,CAAC,CAAC,OAAD,CAAD,CAAWkC,IAAX,CAAgBF,GAAG,CAAClB,IAAJ,CAASV,OAAzB;QACAJ,CAAC,CAAC,WAAD,CAAD,CAAekC,IAAf,CAAoB5B,QAApB;QACAN,CAAC,CAAC,OAAD,CAAD,CAAWkC,IAAX,CAAgBF,GAAG,CAAClB,IAAJ,CAASP,IAAzB;QACAP,CAAC,CAAC,QAAD,CAAD,CAAYkC,IAAZ,CAAiBF,GAAG,CAAClB,IAAJ,CAASG,KAA1B;MACD,CAZD;IAaD,CAnBM;;IAoBP;IACAkB,IAAI,GAAG;MACL,KAAKnB,QAAL,CAAcC,KAAd,GAAsBT,IAAtB;MACA,KAAKQ,QAAL,CAAcZ,OAAd,GAAwBA,OAAxB;MACA,KAAKY,QAAL,CAAcX,GAAd,GAAoBA,GAApB;MACA,KAAKW,QAAL,CAAcT,IAAd,GAAqBA,IAArB;MACA,KAAKS,QAAL,CAAcV,QAAd,GAAyBA,QAAzB;MACA,KAAKU,QAAL,CAAcP,IAAd,GAAqBA,IAArB;MACA,KAAKM,wBAAL,GAAgC,IAAhC;IACD,CA7BM;;IA8BP;IACAqB,UAAU,CAACC,QAAD,EAAW;MACnB,KAAKC,KAAL,CAAWD,QAAX,EAAqBE,QAArB,CAA+BC,KAAD,IAAW;QACvC,IAAIA,KAAJ,EAAW;UAAK;UACdvC,OAAO,CAAC6B,IAAR,CAAa,gBAAb,EAA+B,KAAKd,QAApC,EAA8Ce,IAA9C,CAAmDC,GAAE,IAAK;YACxD7B,SAAS,CAAC;cACRmB,IAAI,EAAE,SADE;cAERF,OAAO,EAAE;YAFD,CAAD,CAAT;YAIA,KAAKP,QAAL;YACA,KAAKE,wBAAL,GAAgC,KAAhC;UACD,CAPD;QAQF,CATA,MASO;UAAS;UACd,OAAO,KAAP;QACF;MACD,CAbD;IAcD;;EA9CM;AAxDI,CAAf","names":["User","Message","Clock","Male","Location","$","request","moment","ElMessage","petname","sex","birthday","area","mail","role","name","components","created","loadData","data","dialogFormVisibleForEdit","ruleForm","email","rules","required","message","trigger","type","methods","userEmail","sessionStorage","getItem","reg","RegExp","replace","post","then","res","format","html","edit","submitForm","formName","$refs","validate","valid"],"sourceRoot":"","sources":["/Users/wangjin/Desktop/newspublisher/Vue/src/views/user/SelfInfo.vue"],"sourcesContent":["<template>\n  <!--详细描述-->\n  <div class=\"dF\">\n    <el-descriptions\n        class=\"margin-top\"\n        title=\"个人信息\"\n        direction=\"vertical\"\n        :column=\"3\"\n        border>\n      <template #extra>\n        <el-button @click=\"edit()\" type=\"primary\">修改</el-button>\n      </template>\n      <el-descriptions-item>\n        <template #label>\n          <div class=\"cell-item\">\n            <el-icon>\n              <user />\n            </el-icon>\n            昵称\n          </div>\n        </template>\n        <el-tag size=\"big\"><span id=\"name\"></span></el-tag>\n      </el-descriptions-item>\n      <el-descriptions-item>\n        <template #label>\n          <div class=\"cell-item\">\n            <el-icon>\n              <male />\n            </el-icon>\n            性别\n          </div>\n        </template>\n        <el-tag size=\"big\"><span id=\"sex\"></span></el-tag>\n      </el-descriptions-item>\n      <el-descriptions-item>\n        <template #label>\n          <div class=\"cell-item\">\n            <el-icon>\n              <clock />\n            </el-icon>\n            生日\n          </div>\n        </template>\n        <el-tag size=\"big\"><span id=\"birthday\"></span></el-tag>\n      </el-descriptions-item>\n      <el-descriptions-item>\n        <template #label>\n          <div class=\"cell-item\">\n            <el-icon>\n              <location />\n            </el-icon>\n            地区\n          </div>\n        </template>\n        <el-tag size=\"big\"><span id=\"area\"></span></el-tag>\n      </el-descriptions-item>\n      <el-descriptions-item>\n        <template #label>\n          <div class=\"cell-item\">\n            <el-icon>\n              <message />\n            </el-icon>\n            邮箱\n          </div>\n        </template>\n        <el-tag size=\"big\"><span id=\"email\"></span></el-tag>\n      </el-descriptions-item>\n    </el-descriptions>\n  </div>\n  <!--修改弹窗，点击修改时才显示-->\n  <el-dialog v-model=\"dialogFormVisibleForEdit\" title=\"修改个人信息\" width=\"40%\">\n    <el-form\n        ref=\"ruleForm\"\n        :model=\"ruleForm\"\n        :rules=\"rules\"\n        label-width=\"80px\"\n        class=\"demo-ruleForm\">\n      <el-form-item label=\"昵称\" prop=\"petname\">\n        <el-input v-model=\"ruleForm.petname\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"性别\" prop=\"sex\">\n        <el-radio-group v-model=\"ruleForm.sex\" class=\"el1\">\n          <el-radio label=\"男\" class=\"man\"></el-radio>\n          <el-radio label=\"女\" class=\"woman\"></el-radio>\n        </el-radio-group>\n      </el-form-item>\n      <el-form-item label=\"生日\" required>\n        <el-col :span=\"11\" class=\"el2\">\n          <el-form-item prop=\"birthday\">\n            <el-date-picker\n                v-model=\"ruleForm.birthday\"\n                type=\"date\"\n                placeholder=\"选择您的生日\"\n                class=\"el1\">\n            </el-date-picker>\n          </el-form-item>\n        </el-col>\n      </el-form-item>\n      <el-form-item label=\"地区\" prop=\"area\">\n        <el-select v-model=\"ruleForm.area\" placeholder=\"请选择省份\" class=\"el1\">\n          <el-option label=\"河南省\" value=\"河南省\"></el-option>\n          <el-option label=\"北京市\" value=\"北京市\"></el-option>\n          <el-option label=\"上海市\" value=\"上海市\"></el-option>\n          <el-option label=\"天津市\" value=\"天津市\"></el-option>\n          <el-option label=\"重庆市\" value=\"重庆市\"></el-option>\n          <el-option label=\"黑龙江省\" value=\"黑龙江省\"></el-option>\n          <el-option label=\"辽宁省\" value=\"辽宁省\"></el-option>\n          <el-option label=\"吉林省\" value=\"吉林省\"></el-option>\n          <el-option label=\"河北省\" value=\"河北省\"></el-option>\n          <el-option label=\"湖北省\" value=\"湖北省\"></el-option>\n          <el-option label=\"湖南省\" value=\"湖南省\"></el-option>\n          <el-option label=\"山东省\" value=\"山东省\"></el-option>\n          <el-option label=\"山西省\" value=\"山西省\"></el-option>\n          <el-option label=\"陕西省\" value=\"陕西省\"></el-option>\n          <el-option label=\"安徽省\" value=\"安徽省\"></el-option>\n          <el-option label=\"浙江省\" value=\"浙江省\"></el-option>\n          <el-option label=\"江苏省\" value=\"江苏省\"></el-option>\n          <el-option label=\"福建省\" value=\"福建省\"></el-option>\n          <el-option label=\"广东省\" value=\"广东省\"></el-option>\n          <el-option label=\"海南省\" value=\"海南省\"></el-option>\n          <el-option label=\"四川省\" value=\"四川省\"></el-option>\n          <el-option label=\"云南省\" value=\"云南省\"></el-option>\n          <el-option label=\"贵州省\" value=\"贵州省\"></el-option>\n          <el-option label=\"青海省\" value=\"青海省\"></el-option>\n          <el-option label=\"甘肃省\" value=\"甘肃省\"></el-option>\n          <el-option label=\"江西省\" value=\"江西省\"></el-option>\n          <el-option label=\"台湾省\" value=\"台湾省\"></el-option>\n          <el-option label=\"内蒙古自治区\" value=\"内蒙古自治区\"></el-option>\n          <el-option label=\"宁夏回族自治区\" value=\"宁夏回族自治区\"></el-option>\n          <el-option label=\"新疆维吾尔自治区\" value=\"新疆维吾尔自治区\"></el-option>\n          <el-option label=\"西藏自治区\" value=\"西藏自治区\"></el-option>\n          <el-option label=\"广西壮族自治区\" value=\"广西壮族自治区\"></el-option>\n          <el-option label=\"香港特别行政区\" value=\"香港特别行政区\"></el-option>\n          <el-option label=\"澳门特别行政区\" value=\"澳门特别行政区\"></el-option>\n        </el-select>\n      </el-form-item>\n    </el-form>\n    <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button @click=\"dialogFormVisibleForEdit=false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"submitForm('ruleForm')\">确定</el-button>\n      </span>\n    </template>\n  </el-dialog>\n\n</template>\n\n<script>\nimport User from \"@element-plus/icons/lib/User\";\nimport Message from \"@element-plus/icons/lib/Message\";\nimport Clock from \"@element-plus/icons/lib/Clock\";\nimport Male from \"@element-plus/icons/lib/Male\";\nimport Location from \"@element-plus/icons/lib/Location\";\nimport $ from '../../assets/js/jquery-3.6.0';\nimport request from \"../../utils/request\";\nimport moment from \"moment\";\nimport {ElMessage} from \"element-plus\";\n\nlet petname;\nlet sex;\nlet birthday;\nlet area;\nlet mail;\nlet role;\n\nexport default {\n  name: \"SelfInfo\",\n  components: {\n    User,\n    Location,\n    Message,\n    Clock,\n    Male\n  },\n  created() {\n    this.loadData()\n  },\n  data() {\n    return {\n      dialogFormVisibleForEdit: false,\n      ruleForm: {\n        email: '',\n        petname: '',\n        sex: '',\n        birthday: '',\n        area: '',\n        role: 0\n      },\n      rules: {\n        petname:[\n          {\n            required: true,\n            message: '请输入昵称',\n            trigger: 'blur',\n          },\n        ],\n        sex: [\n          {\n            required: true,\n            message: '请输入性别',\n            trigger: 'change',\n          },\n        ],\n        birthday: [\n          {\n            type: 'date',\n            required: true,\n            message: '请选择生日',\n            trigger: 'change',\n          },\n        ],\n        area: [\n          {\n            required: true,\n            message: '请选择省份',\n            trigger: 'change',\n          },\n        ],\n      }\n    }\n  },\n  methods: {\n    //加载数据\n    loadData() {\n      let userEmail = sessionStorage.getItem(\"userEmail\");   //从session中取出\n      let reg = new RegExp('\"', \"g\");\n      let email = userEmail.replace(reg, \"\");    //正则表达式，将字符串两端的双引号去掉\n      request.post(\"/user/get\",email).then(res =>{\n        petname = res.data.petname\n        sex = res.data.sex\n        birthday = moment(res.data.birthday).format(\"YYYY-MM-DD\")\n        area = res.data.area\n        mail = res.data.email\n        role = res.data.role\n        $('#sex').html(res.data.sex)\n        $('#name').html(res.data.petname)\n        $('#birthday').html(birthday)\n        $('#area').html(res.data.area)\n        $('#email').html(res.data.email)\n      })\n    },\n    //修改\n    edit() {\n      this.ruleForm.email = mail\n      this.ruleForm.petname = petname\n      this.ruleForm.sex = sex\n      this.ruleForm.area = area\n      this.ruleForm.birthday = birthday\n      this.ruleForm.role = role\n      this.dialogFormVisibleForEdit = true\n    },\n    //提交表单\n    submitForm(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {    //如果表单不空\n          request.post(\"/user/editUser\", this.ruleForm).then(res => {\n            ElMessage({\n              type: 'success',\n              message: '修改成功'\n            })\n            this.loadData()\n            this.dialogFormVisibleForEdit = false\n          })\n        } else {        //如果表单为空\n          return false\n        }\n      })\n    },\n  }\n}\n</script>\n\n<style scoped>\n.dF{\n  width: 80%;position: absolute;left: 7%;right: 5%;margin-top: 120px;\n}\n.el1{\n  width: 100%;\n}\n.man{\n  position: absolute;transform: translate(-50%,-50%);left: 20%;top: 50%;\n}\n.woman{\n  position: absolute;transform: translate(-50%,-50%);right: 20%;top: 50%;\n}\n.el2{\n  max-width: 100%;width: 100%;\n}\n</style>"]},"metadata":{},"sourceType":"module"}