{"ast":null,"code":"import request from \"../../utils/request\";\nimport { ElMessage } from \"element-plus\";\nimport moment from 'moment';\nlet editor;\nlet rowForUpdate;\nexport default {\n  name: \"UserManage\",\n\n  data() {\n    return {\n      tableData: [],\n      total: 0,\n      pageSize: 5,\n      currentPage: 1,\n      dialogFormVisibleForDelete: false\n    };\n  },\n\n  created() {\n    this.loadData();\n  },\n\n  methods: {\n    //格式化日期\n    timeFilter(row, column, cellValue, index) {\n      const date = row[column.property];\n\n      if (date != null) {\n        return moment(date).format(\"YYYY-MM-DD\");\n      }\n    },\n\n    //当前页码改变\n    handleCurrentChange() {\n      this.loadData();\n    },\n\n    //加载数据\n    loadData() {\n      request.get(\"/user/getAllUserNotAdmin\", {\n        params: {\n          currentPage: this.currentPage,\n          pageSize: this.pageSize\n        }\n      }).then(res => {\n        this.tableData = res.data.records;\n        this.total = res.data.total;\n      });\n    },\n\n    //删除用户\n    delete(row) {\n      rowForUpdate = row;\n      this.dialogFormVisibleForDelete = true;\n    },\n\n    //确认删除\n    conformDelete() {\n      request.post(\"/user/deleteUserByEmail\", rowForUpdate.email).then(res => {\n        ElMessage({\n          type: 'success',\n          message: '删除成功'\n        });\n        this.loadData(); //请求后的操作要放到请求的大括号里面，否则异步操作会造成加载时数据没有更新\n\n        this.dialogFormVisibleForDelete = false;\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAuCA,OAAOA,OAAP,MAAoB,qBAApB;AACA,SAAQC,SAAR,QAAwB,cAAxB;AACA,OAAOC,MAAP,MAAmB,QAAnB;AAEA,IAAIC,MAAJ;AACA,IAAIC,YAAJ;AACA,eAAe;EACbC,IAAI,EAAE,YADO;;EAEbC,IAAI,GAAG;IACL,OAAO;MACLC,SAAS,EAAE,EADN;MAILC,KAAK,EAAE,CAJF;MAKLC,QAAQ,EAAE,CALL;MAMLC,WAAW,EAAE,CANR;MAOLC,0BAA0B,EAAE;IAPvB,CAAP;EASD,CAZY;;EAabC,OAAO,GAAG;IACR,KAAKC,QAAL;EACD,CAfY;;EAgBbC,OAAO,EAAE;IACP;IACAC,UAAU,CAACC,GAAD,EAAMC,MAAN,EAAcC,SAAd,EAAyBC,KAAzB,EAAgC;MACxC,MAAMC,IAAG,GAAIJ,GAAG,CAACC,MAAM,CAACI,QAAR,CAAhB;;MACA,IAAGD,IAAG,IAAI,IAAV,EAAe;QACb,OAAOlB,MAAM,CAACkB,IAAD,CAAN,CAAaE,MAAb,CAAoB,YAApB,CAAP;MACF;IACD,CAPM;;IAQP;IACAC,mBAAmB,GAAG;MACpB,KAAKV,QAAL;IACD,CAXM;;IAYP;IACAA,QAAQ,GAAG;MACTb,OAAO,CAACwB,GAAR,CAAY,0BAAZ,EAAuC;QACrCC,MAAM,EAAE;UACNf,WAAW,EAAE,KAAKA,WADZ;UAEND,QAAQ,EAAE,KAAKA;QAFT;MAD6B,CAAvC,EAKGiB,IALH,CAKQC,GAAE,IAAK;QACb,KAAKpB,SAAL,GAAiBoB,GAAG,CAACrB,IAAJ,CAASsB,OAA1B;QACA,KAAKpB,KAAL,GAAamB,GAAG,CAACrB,IAAJ,CAASE,KAAtB;MACD,CARD;IASD,CAvBM;;IAwBP;IACAqB,MAAM,CAACb,GAAD,EAAM;MACVZ,YAAW,GAAIY,GAAf;MACA,KAAKL,0BAAL,GAAkC,IAAlC;IACD,CA5BM;;IA6BP;IACAmB,aAAa,GAAG;MACd9B,OAAO,CAAC+B,IAAR,CAAa,yBAAb,EAAuC3B,YAAY,CAAC4B,KAApD,EAA2DN,IAA3D,CAAgEC,GAAE,IAAI;QACpE1B,SAAS,CAAC;UACRgC,IAAI,EAAE,SADE;UAERC,OAAO,EAAE;QAFD,CAAD,CAAT;QAIA,KAAKrB,QAAL,GALoE,CAK9C;;QACtB,KAAKF,0BAAL,GAAkC,KAAlC;MACD,CAPD;IAQF;;EAvCO;AAhBI,CAAf","names":["request","ElMessage","moment","editor","rowForUpdate","name","data","tableData","total","pageSize","currentPage","dialogFormVisibleForDelete","created","loadData","methods","timeFilter","row","column","cellValue","index","date","property","format","handleCurrentChange","get","params","then","res","records","delete","conformDelete","post","email","type","message"],"sourceRoot":"","sources":["/Users/wangjin/Desktop/newspublisher/Vue/src/views/admin/UserManage.vue"],"sourcesContent":["<template>\n  <div class=\"dF\">\n    <el-table :data=\"tableData\" border class=\"el2\">\n      <el-table-column prop=\"email\" label=\"邮箱\" width=\"\" align=\"center\" />\n      <el-table-column prop=\"petname\" label=\"昵称\" width=\"\" align=\"center\" />\n      <el-table-column prop=\"sex\" label=\"性别\" width=\"50\" align=\"center\" />\n      <el-table-column prop=\"birthday\" label=\"生日\" width=\"100\" align=\"center\" :formatter=\"timeFilter\" />\n      <el-table-column prop=\"area\" label=\"地区\" width=\"140\" align=\"center\" />\n      <el-table-column label=\"操作\" width=\"60\" align=\"center\" key=\"slot\">\n        <!--此处使用了插槽，来实现获得某行的对象-->\n        <template #default=\"scope\" >\n          <el-button type=\"text\" size=\"big\" @click=\"this.delete(scope.row)\">删除</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    <!--分页组件-->\n    <el-pagination\n        background\n        layout=\"total, prev, pager, next\"\n        :total=\"total\"\n        :page-size=\"pageSize\"\n        v-model:currentPage=\"currentPage\"\n        @current-change=\"handleCurrentChange\"\n        class=\"el1\">\n    </el-pagination>\n  </div>\n  <!--删除用户弹窗，点击删除时才显示-->\n  <el-dialog v-model=\"dialogFormVisibleForDelete\" title=\"删除用户\">\n    <span>是否确认删除该用户？</span>\n    <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button @click=\"dialogFormVisibleForDelete = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"conformDelete()\">确定</el-button>\n      </span>\n    </template>\n  </el-dialog>\n</template>\n\n<script>\nimport request from \"../../utils/request\";\nimport {ElMessage} from \"element-plus\";\nimport moment from 'moment';\n\nlet editor;\nlet rowForUpdate;\nexport default {\n  name: \"UserManage\",\n  data() {\n    return {\n      tableData: [\n\n      ],\n      total: 0,\n      pageSize: 5,\n      currentPage: 1,\n      dialogFormVisibleForDelete: false,\n    }\n  },\n  created() {\n    this.loadData()\n  },\n  methods: {\n    //格式化日期\n    timeFilter(row, column, cellValue, index) {\n      const date = row[column.property]\n      if(date !=null){\n        return moment(date).format(\"YYYY-MM-DD\")\n      }\n    },\n    //当前页码改变\n    handleCurrentChange() {\n      this.loadData()\n    },\n    //加载数据\n    loadData() {\n      request.get(\"/user/getAllUserNotAdmin\",{\n        params: {\n          currentPage: this.currentPage,\n          pageSize: this.pageSize\n        }\n      }).then(res => {\n        this.tableData = res.data.records\n        this.total = res.data.total\n      })\n    },\n    //删除用户\n    delete(row) {\n      rowForUpdate = row\n      this.dialogFormVisibleForDelete = true\n    },\n    //确认删除\n    conformDelete() {\n      request.post(\"/user/deleteUserByEmail\",rowForUpdate.email).then(res =>{\n        ElMessage({\n          type: 'success',\n          message: '删除成功'\n        })\n        this.loadData()       //请求后的操作要放到请求的大括号里面，否则异步操作会造成加载时数据没有更新\n        this.dialogFormVisibleForDelete = false\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.dF{\n  width: 90%;position: absolute;left: 5%;right: 5%;margin-top: 50px;\n}\n.el1{\n  margin-top: 15px;\n}\n.el2{\n  width: 100%;\n}\n</style>"]},"metadata":{},"sourceType":"module"}