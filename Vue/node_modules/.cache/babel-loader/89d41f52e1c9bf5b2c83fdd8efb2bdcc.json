{"ast":null,"code":"import HeadOfWelcome from \"../components/HeadOfWelcome\";\nimport request from \"../utils/request\";\nimport { ElMessage } from 'element-plus'; //Element-plus消息提示\n\nlet verify; //验证码\n\nlet role; //用户角色\n\nlet inputEmail; //输入邮箱\n\nexport default {\n  name: \"AdminLogin\",\n  components: {\n    HeadOfWelcome\n  },\n\n  data() {\n    return {\n      ruleForm: {\n        email: '',\n        verifyCode: ''\n      },\n      rules: {\n        email: [{\n          required: true,\n          message: '请输入邮箱',\n          trigger: 'blur'\n        }],\n        verifyCode: [{\n          required: true,\n          message: '请输入验证码',\n          trigger: 'change'\n        }]\n      }\n    };\n  },\n\n  created() {},\n\n  methods: {\n    //发送验证码\n    sendVerifyCode(email) {\n      if (email === '' || email === null) {\n        //如果邮箱为空\n        ElMessage({\n          //消息提示\n          type: \"warning\",\n          message: \"请输入邮箱\"\n        });\n      } else {\n        inputEmail = email;\n        request.post(\"/user/sendEmailForAdmin\", email).then(res => {\n          if (res.code === \"0\") {\n            //说明该用户存在，发送成功\n            verify = res.data;\n            request.post(\"/user/getRole\", email).then(res => {\n              //获取用户角色\n              role = res.data;\n            });\n            ElMessage({\n              //消息提示\n              type: \"success\",\n              message: \"获取成功\"\n            });\n          } else {\n            ElMessage({\n              //消息提示\n              type: \"warning\",\n              message: \"该用户不存在\"\n            });\n          }\n        });\n      }\n    },\n\n    //提交表单\n    submitForm(formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          //如果表单不空\n          if (inputEmail !== this.ruleForm.email) {\n            ElMessage({\n              //消息提示\n              type: \"warning\",\n              message: \"请重新获取验证码\"\n            });\n          } else if (verify !== this.ruleForm.verifyCode) {\n            //获取表单中的数据要通过 ”this.ruleForm.属性“ 来实现\n            ElMessage({\n              //消息提示\n              type: \"warning\",\n              message: \"验证码错误\"\n            });\n          } else if (role === 0 || role === 3) {\n            ElMessage({\n              //消息提示\n              type: \"warning\",\n              message: \"您不是管理员\"\n            });\n          } else {\n            ElMessage({\n              //消息提示\n              type: \"success\",\n              message: \"登录成功\"\n            });\n            sessionStorage.setItem(\"userEmail\", JSON.stringify(this.ruleForm.email)); //将管理员的邮箱存储在session里\n\n            this.$router.push('/adminHome'); //跳转到管理员页面\n          }\n        } else {\n          //如果表单为空\n          return false;\n        }\n      });\n    },\n\n    //重置表单\n    resetForm(formName) {\n      this.$refs[formName].resetFields();\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["HeadOfWelcome","request","ElMessage","verify","role","inputEmail","name","components","data","ruleForm","email","verifyCode","rules","required","message","trigger","created","methods","sendVerifyCode","type","post","then","res","code","submitForm","formName","$refs","validate","valid","sessionStorage","setItem","JSON","stringify","$router","push","resetForm","resetFields"],"sourceRoot":"","sources":["/Users/wangjin/Desktop/newspublisher/Vue/src/layout/AdminLogin.vue"],"sourcesContent":["<template>\n  <!--头部-->\n  <HeadOfWelcome/>\n  <div class=\"divFirst\">\n    <p class=\"p1\">管理员登录</p>\n    <div class=\"div2\">\n      <el-form\n          ref=\"ruleForm\"\n          :model=\"ruleForm\"\n          :rules=\"rules\"\n          label-width=\"80px\"\n          class=\"demo-ruleForm\">\n        <el-form-item label=\"邮箱\" prop=\"email\">\n          <el-input v-model=\"ruleForm.email\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"验证码\" prop=\"verifyCode\">\n          <el-input v-model=\"ruleForm.verifyCode\" class=\"el1\"></el-input>\n          <el-button type=\"primary\" @click=\"sendVerifyCode(ruleForm.email)\" class=\"el2\">获取验证码</el-button>\n        </el-form-item>\n        <el-form-item class=\"el3\">\n          <el-button type=\"primary\" @click=\"submitForm('ruleForm')\" class=\"el4\">登录</el-button>\n          <el-button @click=\"resetForm('ruleForm')\" class=\"el5\">重置</el-button>\n        </el-form-item>\n      </el-form>\n      <router-link to=\"/superAdminLogin\" class=\"link1\">超级管理员登录入口>></router-link>\n    </div>\n  </div>\n</template>\n\n<script>\nimport HeadOfWelcome from \"../components/HeadOfWelcome\";\nimport request from \"../utils/request\";\nimport { ElMessage } from 'element-plus'   //Element-plus消息提示\n\nlet verify;   //验证码\nlet role;     //用户角色\nlet inputEmail;  //输入邮箱\n\nexport default {\n  name: \"AdminLogin\",\n  components: {HeadOfWelcome},\n\n  data() {\n    return {\n      ruleForm: {\n        email: '',\n        verifyCode: '',\n      },\n      rules: {\n        email: [\n          {\n            required: true,\n            message: '请输入邮箱',\n            trigger: 'blur',\n          },\n        ],\n        verifyCode: [\n          {\n            required: true,\n            message: '请输入验证码',\n            trigger: 'change',\n          },\n        ],\n      },\n    }\n  },\n  created() {\n\n  },\n  methods: {\n    //发送验证码\n    sendVerifyCode(email) {\n      if (email===''||email===null){  //如果邮箱为空\n        ElMessage({    //消息提示\n          type: \"warning\",\n          message: \"请输入邮箱\"\n        })\n      }else {\n        inputEmail = email\n        request.post(\"/user/sendEmailForAdmin\",email).then(res =>{\n          if (res.code===\"0\") {  //说明该用户存在，发送成功\n            verify = res.data;\n            request.post(\"/user/getRole\",email).then(res =>{      //获取用户角色\n              role = res.data;\n            })\n            ElMessage({    //消息提示\n              type: \"success\",\n              message: \"获取成功\"\n            })\n          }else {\n            ElMessage({    //消息提示\n              type: \"warning\",\n              message: \"该用户不存在\"\n            })\n          }\n        })\n      }\n    },\n    //提交表单\n    submitForm(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {    //如果表单不空\n          if (inputEmail!==this.ruleForm.email) {\n            ElMessage({    //消息提示\n              type: \"warning\",\n              message: \"请重新获取验证码\"\n            })\n          }else if (verify!==this.ruleForm.verifyCode) {  //获取表单中的数据要通过 ”this.ruleForm.属性“ 来实现\n            ElMessage({    //消息提示\n              type: \"warning\",\n              message: \"验证码错误\"\n            })\n          }else if (role===0||role===3) {\n            ElMessage({    //消息提示\n              type: \"warning\",\n              message: \"您不是管理员\"\n            })\n          }else {\n            ElMessage({    //消息提示\n              type: \"success\",\n              message: \"登录成功\"\n            })\n            sessionStorage.setItem(\"userEmail\", JSON.stringify(this.ruleForm.email));  //将管理员的邮箱存储在session里\n            this.$router.push('/adminHome');    //跳转到管理员页面\n          }\n        } else {            //如果表单为空\n          return false\n        }\n      })\n    },\n    //重置表单\n    resetForm(formName) {\n      this.$refs[formName].resetFields()\n    },\n  },\n}\n</script>\n\n<style scoped>\n.divFirst{\n  background: white;position: absolute;width: 100%;left: 50%;top: calc(50% + 25px);transform: translate(-50%,-50%);height: calc(100% - 50px);\n}\n.p1{\n  text-align: center;font-size: 22px;color: rgb(64, 158, 255);position: absolute;left: 30%;right: 30%;width: 40%;margin-top: 70px;padding: 10px;\n}\n.div2{\n  position: absolute;left: 33%;width: 30%;right: 35%;margin-top: 160px;\n}\n.el1{\n  width: 45%;margin-right: 5%;\n}\n.el2{\n  width: 50%;\n}\n.el3{\n  display:block;\n}\n.el4{\n  width: 40%;\n}\n.el5{\n  width: 40%;margin-left: 20%;\n}\n.link1{\n  position: absolute;width: 100%;color: rgb(96, 98, 102);font-size: 13px;text-align: right;\n}\n</style>"]},"metadata":{},"sourceType":"module"}