{"remainingRequest":"/Users/wangjin/Desktop/newspublisher/Vue/node_modules/babel-loader/lib/index.js!/Users/wangjin/Desktop/newspublisher/Vue/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/wangjin/Desktop/newspublisher/Vue/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/wangjin/Desktop/newspublisher/Vue/src/views/user/MyMessageOfNotRead.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/wangjin/Desktop/newspublisher/Vue/src/views/user/MyMessageOfNotRead.vue","mtime":1655214349249},{"path":"/Users/wangjin/Desktop/newspublisher/Vue/babel.config.js","mtime":1655079911438},{"path":"/Users/wangjin/Desktop/newspublisher/Vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangjin/Desktop/newspublisher/Vue/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/wangjin/Desktop/newspublisher/Vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangjin/Desktop/newspublisher/Vue/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmNvbnN0cnVjdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmRvdC1hbGwuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5zdGlja3kuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UuanMiOwppbXBvcnQgcmVxdWVzdCBmcm9tICIuLi8uLi91dGlscy9yZXF1ZXN0IjsKaW1wb3J0IHsgRWxNZXNzYWdlIH0gZnJvbSAiZWxlbWVudC1wbHVzIjsKaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnOwppbXBvcnQgJCBmcm9tICcuLi8uLi9hc3NldHMvanMvanF1ZXJ5LTMuNi4wJzsKdmFyIHVzZXJFbWFpbDsKdmFyIG1lc3NhZ2VJZDsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJNeU1lc3NhZ2VPZk5vdFJlYWQiLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB0YWJsZURhdGE6IFtdLAogICAgICB0b3RhbDogMCwKICAgICAgcGFnZVNpemU6IDUsCiAgICAgIGN1cnJlbnRQYWdlOiAxLAogICAgICBkaWFsb2dGb3JtVmlzaWJsZUZvckxvb2s6IGZhbHNlLAogICAgICBkaWFsb2dGb3JtVmlzaWJsZUZvckRlbGV0ZTogZmFsc2UsCiAgICAgIGRpYWxvZ0Zvcm1WaXNpYmxlRm9yUmVhZDogZmFsc2UKICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5sb2FkRGF0YSgpOwogIH0sCiAgbWV0aG9kczogewogICAgLy/moLzlvI/ljJbml6XmnJ8KICAgIHRpbWVGaWx0ZXI6IGZ1bmN0aW9uIHRpbWVGaWx0ZXIocm93LCBjb2x1bW4sIGNlbGxWYWx1ZSwgaW5kZXgpIHsKICAgICAgdmFyIGRhdGUgPSByb3dbY29sdW1uLnByb3BlcnR5XTsKCiAgICAgIGlmIChkYXRlICE9IG51bGwpIHsKICAgICAgICByZXR1cm4gbW9tZW50KGRhdGUpLmZvcm1hdCgiWVlZWS1NTS1ERCIpOwogICAgICB9CiAgICB9LAogICAgLy/lvZPliY3pobXnoIHmlLnlj5gKICAgIGhhbmRsZUN1cnJlbnRDaGFuZ2U6IGZ1bmN0aW9uIGhhbmRsZUN1cnJlbnRDaGFuZ2UoKSB7CiAgICAgIHRoaXMubG9hZERhdGEoKTsKICAgIH0sCiAgICAvL+WKoOi9veaVsOaNrgogICAgbG9hZERhdGE6IGZ1bmN0aW9uIGxvYWREYXRhKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGVtYWlsID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgidXNlckVtYWlsIik7CiAgICAgIHZhciByZWcgPSBuZXcgUmVnRXhwKCciJywgImciKTsKICAgICAgdXNlckVtYWlsID0gZW1haWwucmVwbGFjZShyZWcsICIiKTsgLy/mraPliJnooajovr7lvI/vvIzlsIblrZfnrKbkuLLkuKTnq6/nmoTlj4zlvJXlj7fljrvmjokKCiAgICAgIHJlcXVlc3QuZ2V0KCIvbWVzc2FnZV9Vc2VyL2dldEFsbE5vdFJlYWQiLCB7CiAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICB1c2VyRW1haWw6IHVzZXJFbWFpbCwKICAgICAgICAgIGN1cnJlbnRQYWdlOiB0aGlzLmN1cnJlbnRQYWdlLAogICAgICAgICAgcGFnZVNpemU6IHRoaXMucGFnZVNpemUKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIF90aGlzLnRhYmxlRGF0YSA9IHJlcy5kYXRhLnJlY29yZHM7CiAgICAgICAgX3RoaXMudG90YWwgPSByZXMuZGF0YS50b3RhbDsKICAgICAgfSk7CiAgICB9LAogICAgLy/mn6XnnIvor6bmg4UKICAgIGxvb2s6IGZ1bmN0aW9uIGxvb2soY29udGVudCkgewogICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlRm9yTG9vayA9IHRydWU7CiAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAkKCcjY29udGVudCcpLmh0bWwoY29udGVudCk7CiAgICAgIH0pOwogICAgfSwKICAgIC8v5Yig6ZmkCiAgICBkZWxldGU6IGZ1bmN0aW9uIF9kZWxldGUoaWQpIHsKICAgICAgbWVzc2FnZUlkID0gaWQ7CiAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGVGb3JEZWxldGUgPSB0cnVlOwogICAgfSwKICAgIC8v56Gu6K6k5Yig6ZmkCiAgICBjb25mb3JtRGVsZXRlOiBmdW5jdGlvbiBjb25mb3JtRGVsZXRlKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJlcXVlc3QucG9zdCgiL21lc3NhZ2UvZGVsZXRlTWVzc2FnZSIsIG1lc3NhZ2VJZCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgRWxNZXNzYWdlKHsKICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgIG1lc3NhZ2U6ICfliKDpmaTmiJDlip8nCiAgICAgICAgfSk7CgogICAgICAgIF90aGlzMi5sb2FkRGF0YSgpOwoKICAgICAgICBfdGhpczIuZGlhbG9nRm9ybVZpc2libGVGb3JEZWxldGUgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9LAogICAgLy/moIforrDlt7Lor7sKICAgIHJlYWQ6IGZ1bmN0aW9uIHJlYWQoaWQpIHsKICAgICAgbWVzc2FnZUlkID0gaWQ7CiAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGVGb3JSZWFkID0gdHJ1ZTsKICAgIH0sCiAgICAvL+ehruiupOagh+iusAogICAgY29uZm9ybVJlYWQ6IGZ1bmN0aW9uIGNvbmZvcm1SZWFkKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHJlcXVlc3QucG9zdCgiL21lc3NhZ2Uvc2V0TWVzc2FnZVJlYWRlZCIsIG1lc3NhZ2VJZCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgX3RoaXMzLmxvYWREYXRhKCk7CgogICAgICAgIF90aGlzMy5kaWFsb2dGb3JtVmlzaWJsZUZvclJlYWQgPSBmYWxzZTsKICAgICAgICBFbE1lc3NhZ2UoewogICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgbWVzc2FnZTogJ+agh+iusOaIkOWKnycKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["/Users/wangjin/Desktop/newspublisher/Vue/src/views/user/MyMessageOfNotRead.vue"],"names":[],"mappings":";;;;;;AA2DA,OAAO,OAAP,MAAoB,qBAApB;AACA,SAAQ,SAAR,QAAwB,cAAxB;AACA,OAAO,MAAP,MAAmB,QAAnB;AACA,OAAO,CAAP,MAAc,8BAAd;AACA,IAAI,SAAJ;AACA,IAAI,SAAJ;AAEA,eAAe;AACb,EAAA,IAAI,EAAE,oBADO;AAEb,EAAA,IAFa,kBAEN;AACL,WAAO;AACL,MAAA,SAAS,EAAE,EADN;AAIL,MAAA,KAAK,EAAE,CAJF;AAKL,MAAA,QAAQ,EAAE,CALL;AAML,MAAA,WAAW,EAAE,CANR;AAOL,MAAA,wBAAwB,EAAE,KAPrB;AAQL,MAAA,0BAA0B,EAAE,KARvB;AASL,MAAA,wBAAwB,EAAE;AATrB,KAAP;AAWD,GAdY;AAeb,EAAA,OAfa,qBAeH;AACR,SAAK,QAAL;AACD,GAjBY;AAkBb,EAAA,OAAO,EAAE;AACP;AACA,IAAA,UAFO,sBAEI,GAFJ,EAES,MAFT,EAEiB,SAFjB,EAE4B,KAF5B,EAEmC;AACxC,UAAM,IAAG,GAAI,GAAG,CAAC,MAAM,CAAC,QAAR,CAAhB;;AACA,UAAG,IAAG,IAAI,IAAV,EAAe;AACb,eAAO,MAAM,CAAC,IAAD,CAAN,CAAa,MAAb,CAAoB,YAApB,CAAP;AACF;AACD,KAPM;AAQP;AACA,IAAA,mBATO,iCASe;AACpB,WAAK,QAAL;AACD,KAXM;AAYP;AACA,IAAA,QAbO,sBAaI;AAAA;;AACT,UAAI,KAAI,GAAI,cAAc,CAAC,OAAf,CAAuB,WAAvB,CAAZ;AACA,UAAI,GAAE,GAAI,IAAI,MAAJ,CAAW,GAAX,EAAgB,GAAhB,CAAV;AACA,MAAA,SAAQ,GAAI,KAAK,CAAC,OAAN,CAAc,GAAd,EAAmB,EAAnB,CAAZ,CAHS,CAG8B;;AACvC,MAAA,OAAO,CAAC,GAAR,CAAY,6BAAZ,EAA0C;AACxC,QAAA,MAAM,EAAE;AACN,UAAA,SAAS,EAAE,SADL;AAEN,UAAA,WAAW,EAAE,KAAK,WAFZ;AAGN,UAAA,QAAQ,EAAE,KAAK;AAHT;AADgC,OAA1C,EAMG,IANH,CAMQ,UAAA,GAAE,EAAK;AACb,QAAA,KAAI,CAAC,SAAL,GAAiB,GAAG,CAAC,IAAJ,CAAS,OAA1B;AACA,QAAA,KAAI,CAAC,KAAL,GAAa,GAAG,CAAC,IAAJ,CAAS,KAAtB;AACD,OATD;AAUD,KA3BM;AA4BP;AACA,IAAA,IA7BO,gBA6BF,OA7BE,EA6BO;AACZ,WAAK,wBAAL,GAAgC,IAAhC;AACA,WAAK,SAAL,CAAe,YAAM;AACnB,QAAA,CAAC,CAAC,UAAD,CAAD,CAAc,IAAd,CAAmB,OAAnB;AACD,OAFD;AAGD,KAlCM;AAmCP;AACA,IAAA,MApCO,mBAoCA,EApCA,EAoCI;AACT,MAAA,SAAQ,GAAI,EAAZ;AACA,WAAK,0BAAL,GAAkC,IAAlC;AACD,KAvCM;AAwCP;AACA,IAAA,aAzCO,2BAyCS;AAAA;;AACd,MAAA,OAAO,CAAC,IAAR,CAAa,wBAAb,EAAsC,SAAtC,EAAiD,IAAjD,CAAsD,UAAA,GAAE,EAAI;AAC1D,QAAA,SAAS,CAAC;AACR,UAAA,IAAI,EAAE,SADE;AAER,UAAA,OAAO,EAAE;AAFD,SAAD,CAAT;;AAIA,QAAA,MAAI,CAAC,QAAL;;AACA,QAAA,MAAI,CAAC,0BAAL,GAAkC,KAAlC;AACD,OAPD;AAQD,KAlDM;AAmDP;AACA,IAAA,IApDO,gBAoDF,EApDE,EAoDE;AACP,MAAA,SAAQ,GAAI,EAAZ;AACA,WAAK,wBAAL,GAAgC,IAAhC;AACD,KAvDM;AAwDP;AACA,IAAA,WAzDO,yBAyDO;AAAA;;AACZ,MAAA,OAAO,CAAC,IAAR,CAAa,2BAAb,EAAyC,SAAzC,EAAoD,IAApD,CAAyD,UAAA,GAAE,EAAI;AAC7D,QAAA,MAAI,CAAC,QAAL;;AACA,QAAA,MAAI,CAAC,wBAAL,GAAgC,KAAhC;AACA,QAAA,SAAS,CAAC;AACR,UAAA,IAAI,EAAE,SADE;AAER,UAAA,OAAO,EAAE;AAFD,SAAD,CAAT;AAID,OAPD;AAQF;AAlEO;AAlBI,CAAf","sourcesContent":["<template>\n  <div class=\"dF\">\n    <el-table :data=\"tableData\" border class=\"el1\">\n      <el-table-column prop=\"headline\" label=\"主题\" width=\"\" align=\"center\" />\n      <el-table-column prop=\"petname\" label=\"发送人\" width=\"170\" align=\"center\" />\n      <el-table-column prop=\"date\" label=\"日期\" width=\"100\" align=\"center\" :formatter=\"timeFilter\"/>\n      <el-table-column label=\"操作\" width=\"160\" align=\"center\" key=\"slot\">\n        <!--此处使用了插槽，来实现获得某行的对象-->\n        <template #default=\"scope\" >\n          <el-button type=\"text\" size=\"big\" @click=\"this.look(scope.row.content)\">查看</el-button>\n          <el-button type=\"text\" size=\"big\" @click=\"this.read(scope.row.id)\">标记已读</el-button>\n          <el-button type=\"text\" size=\"big\" @click=\"this.delete(scope.row.id)\">删除</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    <!--分页组件-->\n    <el-pagination\n        background\n        layout=\"total, prev, pager, next\"\n        :total=\"total\"\n        :page-size=\"pageSize\"\n        v-model:currentPage=\"currentPage\"\n        @current-change=\"handleCurrentChange\"\n        class=\"el2\">\n    </el-pagination>\n  </div>\n  <!--删除弹窗，点击删除时才显示-->\n  <el-dialog v-model=\"dialogFormVisibleForDelete\" title=\"删除私信\">\n    <span>是否确认删除该私信？</span>\n    <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button @click=\"dialogFormVisibleForDelete = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"conformDelete()\">确定</el-button>\n      </span>\n    </template>\n  </el-dialog>\n  <!--标记已读弹窗-->\n  <el-dialog v-model=\"dialogFormVisibleForRead\" title=\"标记已读\">\n    <span>是否确认标记该私信已读？</span>\n    <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button @click=\"dialogFormVisibleForRead = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"conformRead()\">确定</el-button>\n      </span>\n    </template>\n  </el-dialog>\n  <!--查看私信-->\n  <el-dialog v-model=\"dialogFormVisibleForLook\" title=\"查看私信\">\n    <div id=\"content\"></div>\n    <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button type=\"primary\" @click=\"dialogFormVisibleForLook=false\">关闭</el-button>\n      </span>\n    </template>\n  </el-dialog>\n\n</template>\n\n<script>\nimport request from \"../../utils/request\";\nimport {ElMessage} from \"element-plus\";\nimport moment from 'moment';\nimport $ from '../../assets/js/jquery-3.6.0';\nlet userEmail;\nlet messageId;\n\nexport default {\n  name: \"MyMessageOfNotRead\",\n  data() {\n    return {\n      tableData: [\n\n      ],\n      total: 0,\n      pageSize: 5,\n      currentPage: 1,\n      dialogFormVisibleForLook: false,\n      dialogFormVisibleForDelete: false,\n      dialogFormVisibleForRead: false\n    }\n  },\n  created() {\n    this.loadData()\n  },\n  methods: {\n    //格式化日期\n    timeFilter(row, column, cellValue, index) {\n      const date = row[column.property]\n      if(date !=null){\n        return moment(date).format(\"YYYY-MM-DD\")\n      }\n    },\n    //当前页码改变\n    handleCurrentChange() {\n      this.loadData()\n    },\n    //加载数据\n    loadData() {\n      let email = sessionStorage.getItem(\"userEmail\")\n      let reg = new RegExp('\"', \"g\");\n      userEmail = email.replace(reg, \"\");    //正则表达式，将字符串两端的双引号去掉\n      request.get(\"/message_User/getAllNotRead\",{\n        params: {\n          userEmail: userEmail,\n          currentPage: this.currentPage,\n          pageSize: this.pageSize\n        }\n      }).then(res => {\n        this.tableData = res.data.records\n        this.total = res.data.total\n      })\n    },\n    //查看详情\n    look(content) {\n      this.dialogFormVisibleForLook = true\n      this.$nextTick(() => {\n        $('#content').html(content)\n      })\n    },\n    //删除\n    delete(id) {\n      messageId = id\n      this.dialogFormVisibleForDelete = true\n    },\n    //确认删除\n    conformDelete() {\n      request.post(\"/message/deleteMessage\",messageId).then(res =>{\n        ElMessage({\n          type: 'success',\n          message: '删除成功'\n        })\n        this.loadData()\n        this.dialogFormVisibleForDelete = false\n      })\n    },\n    //标记已读\n    read(id) {\n      messageId = id\n      this.dialogFormVisibleForRead = true\n    },\n    //确认标记\n    conformRead() {\n      request.post(\"/message/setMessageReaded\",messageId).then(res =>{\n        this.loadData()\n        this.dialogFormVisibleForRead = false\n        ElMessage({\n          type: 'success',\n          message: '标记成功'\n        })\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.dF{\n  width: 90%;position: absolute;left: 5%;right: 5%;margin-top: 50px;\n}\n.el1{\n  width: 100%;\n}\n.el2{\n  margin-top: 15px;\n}\n</style>"],"sourceRoot":""}]}