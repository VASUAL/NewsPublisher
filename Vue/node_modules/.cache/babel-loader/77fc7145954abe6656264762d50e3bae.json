{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, createElementVNode as _createElementVNode, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-57fe30f1\"), n = n(), _popScopeId(), n);\n\nconst _hoisted_1 = {\n  class: \"dF\"\n};\n\nconst _hoisted_2 = /*#__PURE__*/_createTextVNode(\"查看\");\n\nconst _hoisted_3 = /*#__PURE__*/_createTextVNode(\"标记已读\");\n\nconst _hoisted_4 = /*#__PURE__*/_createTextVNode(\"删除\");\n\nconst _hoisted_5 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", null, \"是否确认删除该私信？\", -1\n/* HOISTED */\n));\n\nconst _hoisted_6 = {\n  class: \"dialog-footer\"\n};\n\nconst _hoisted_7 = /*#__PURE__*/_createTextVNode(\"取消\");\n\nconst _hoisted_8 = /*#__PURE__*/_createTextVNode(\"确定\");\n\nconst _hoisted_9 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", null, \"是否确认标记该私信已读？\", -1\n/* HOISTED */\n));\n\nconst _hoisted_10 = {\n  class: \"dialog-footer\"\n};\n\nconst _hoisted_11 = /*#__PURE__*/_createTextVNode(\"取消\");\n\nconst _hoisted_12 = /*#__PURE__*/_createTextVNode(\"确定\");\n\nconst _hoisted_13 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  id: \"content\"\n}, null, -1\n/* HOISTED */\n));\n\nconst _hoisted_14 = {\n  class: \"dialog-footer\"\n};\n\nconst _hoisted_15 = /*#__PURE__*/_createTextVNode(\"关闭\");\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_table_column = _resolveComponent(\"el-table-column\");\n\n  const _component_el_button = _resolveComponent(\"el-button\");\n\n  const _component_el_table = _resolveComponent(\"el-table\");\n\n  const _component_el_pagination = _resolveComponent(\"el-pagination\");\n\n  const _component_el_dialog = _resolveComponent(\"el-dialog\");\n\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createElementVNode(\"div\", _hoisted_1, [_createVNode(_component_el_table, {\n    data: $data.tableData,\n    border: \"\",\n    class: \"el1\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_table_column, {\n      prop: \"headline\",\n      label: \"主题\",\n      width: \"\",\n      align: \"center\"\n    }), _createVNode(_component_el_table_column, {\n      prop: \"petname\",\n      label: \"发送人\",\n      width: \"170\",\n      align: \"center\"\n    }), _createVNode(_component_el_table_column, {\n      prop: \"date\",\n      label: \"日期\",\n      width: \"100\",\n      align: \"center\",\n      formatter: $options.timeFilter\n    }, null, 8\n    /* PROPS */\n    , [\"formatter\"]), _createVNode(_component_el_table_column, {\n      label: \"操作\",\n      width: \"160\",\n      align: \"center\",\n      key: \"slot\"\n    }, {\n      default: _withCtx(scope => [_createVNode(_component_el_button, {\n        type: \"text\",\n        size: \"big\",\n        onClick: $event => this.look(scope.row.content)\n      }, {\n        default: _withCtx(() => [_hoisted_2]),\n        _: 2\n        /* DYNAMIC */\n\n      }, 1032\n      /* PROPS, DYNAMIC_SLOTS */\n      , [\"onClick\"]), _createVNode(_component_el_button, {\n        type: \"text\",\n        size: \"big\",\n        onClick: $event => this.read(scope.row.id)\n      }, {\n        default: _withCtx(() => [_hoisted_3]),\n        _: 2\n        /* DYNAMIC */\n\n      }, 1032\n      /* PROPS, DYNAMIC_SLOTS */\n      , [\"onClick\"]), _createVNode(_component_el_button, {\n        type: \"text\",\n        size: \"big\",\n        onClick: $event => this.delete(scope.row.id)\n      }, {\n        default: _withCtx(() => [_hoisted_4]),\n        _: 2\n        /* DYNAMIC */\n\n      }, 1032\n      /* PROPS, DYNAMIC_SLOTS */\n      , [\"onClick\"])]),\n      _: 1\n      /* STABLE */\n\n    })]),\n    _: 1\n    /* STABLE */\n\n  }, 8\n  /* PROPS */\n  , [\"data\"]), _createCommentVNode(\"分页组件\"), _createVNode(_component_el_pagination, {\n    background: \"\",\n    layout: \"total, prev, pager, next\",\n    total: $data.total,\n    \"page-size\": $data.pageSize,\n    currentPage: $data.currentPage,\n    \"onUpdate:currentPage\": _cache[0] || (_cache[0] = $event => $data.currentPage = $event),\n    onCurrentChange: $options.handleCurrentChange,\n    class: \"el2\"\n  }, null, 8\n  /* PROPS */\n  , [\"total\", \"page-size\", \"currentPage\", \"onCurrentChange\"])]), _createCommentVNode(\"删除弹窗，点击删除时才显示\"), _createVNode(_component_el_dialog, {\n    modelValue: $data.dialogFormVisibleForDelete,\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $data.dialogFormVisibleForDelete = $event),\n    title: \"删除私信\"\n  }, {\n    footer: _withCtx(() => [_createElementVNode(\"span\", _hoisted_6, [_createVNode(_component_el_button, {\n      onClick: _cache[1] || (_cache[1] = $event => $data.dialogFormVisibleForDelete = false)\n    }, {\n      default: _withCtx(() => [_hoisted_7]),\n      _: 1\n      /* STABLE */\n\n    }), _createVNode(_component_el_button, {\n      type: \"primary\",\n      onClick: _cache[2] || (_cache[2] = $event => $options.conformDelete())\n    }, {\n      default: _withCtx(() => [_hoisted_8]),\n      _: 1\n      /* STABLE */\n\n    })])]),\n    default: _withCtx(() => [_hoisted_5]),\n    _: 1\n    /* STABLE */\n\n  }, 8\n  /* PROPS */\n  , [\"modelValue\"]), _createCommentVNode(\"标记已读弹窗\"), _createVNode(_component_el_dialog, {\n    modelValue: $data.dialogFormVisibleForRead,\n    \"onUpdate:modelValue\": _cache[6] || (_cache[6] = $event => $data.dialogFormVisibleForRead = $event),\n    title: \"标记已读\"\n  }, {\n    footer: _withCtx(() => [_createElementVNode(\"span\", _hoisted_10, [_createVNode(_component_el_button, {\n      onClick: _cache[4] || (_cache[4] = $event => $data.dialogFormVisibleForRead = false)\n    }, {\n      default: _withCtx(() => [_hoisted_11]),\n      _: 1\n      /* STABLE */\n\n    }), _createVNode(_component_el_button, {\n      type: \"primary\",\n      onClick: _cache[5] || (_cache[5] = $event => $options.conformRead())\n    }, {\n      default: _withCtx(() => [_hoisted_12]),\n      _: 1\n      /* STABLE */\n\n    })])]),\n    default: _withCtx(() => [_hoisted_9]),\n    _: 1\n    /* STABLE */\n\n  }, 8\n  /* PROPS */\n  , [\"modelValue\"]), _createCommentVNode(\"查看私信\"), _createVNode(_component_el_dialog, {\n    modelValue: $data.dialogFormVisibleForLook,\n    \"onUpdate:modelValue\": _cache[8] || (_cache[8] = $event => $data.dialogFormVisibleForLook = $event),\n    title: \"查看私信\"\n  }, {\n    footer: _withCtx(() => [_createElementVNode(\"span\", _hoisted_14, [_createVNode(_component_el_button, {\n      type: \"primary\",\n      onClick: _cache[7] || (_cache[7] = $event => $data.dialogFormVisibleForLook = false)\n    }, {\n      default: _withCtx(() => [_hoisted_15]),\n      _: 1\n      /* STABLE */\n\n    })])]),\n    default: _withCtx(() => [_hoisted_13]),\n    _: 1\n    /* STABLE */\n\n  }, 8\n  /* PROPS */\n  , [\"modelValue\"])], 64\n  /* STABLE_FRAGMENT */\n  );\n}","map":{"version":3,"mappings":"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","names":["class","_createElementVNode","id","_createVNode","_component_el_table","data","$data","border","_component_el_table_column","prop","label","width","align","formatter","$options","key","default","scope","_component_el_button","type","size","onClick","look","row","content","read","delete","_createCommentVNode","_component_el_pagination","background","layout","total","currentPage","$event","onCurrentChange","_component_el_dialog","title","footer","_hoisted_5","_hoisted_9","_hoisted_13"],"sourceRoot":"","sources":["/Users/wangjin/Desktop/newspublisher/Vue/src/views/user/MyMessageOfNotRead.vue"],"sourcesContent":["<template>\n  <div class=\"dF\">\n    <el-table :data=\"tableData\" border class=\"el1\">\n      <el-table-column prop=\"headline\" label=\"主题\" width=\"\" align=\"center\" />\n      <el-table-column prop=\"petname\" label=\"发送人\" width=\"170\" align=\"center\" />\n      <el-table-column prop=\"date\" label=\"日期\" width=\"100\" align=\"center\" :formatter=\"timeFilter\"/>\n      <el-table-column label=\"操作\" width=\"160\" align=\"center\" key=\"slot\">\n        <!--此处使用了插槽，来实现获得某行的对象-->\n        <template #default=\"scope\" >\n          <el-button type=\"text\" size=\"big\" @click=\"this.look(scope.row.content)\">查看</el-button>\n          <el-button type=\"text\" size=\"big\" @click=\"this.read(scope.row.id)\">标记已读</el-button>\n          <el-button type=\"text\" size=\"big\" @click=\"this.delete(scope.row.id)\">删除</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    <!--分页组件-->\n    <el-pagination\n        background\n        layout=\"total, prev, pager, next\"\n        :total=\"total\"\n        :page-size=\"pageSize\"\n        v-model:currentPage=\"currentPage\"\n        @current-change=\"handleCurrentChange\"\n        class=\"el2\">\n    </el-pagination>\n  </div>\n  <!--删除弹窗，点击删除时才显示-->\n  <el-dialog v-model=\"dialogFormVisibleForDelete\" title=\"删除私信\">\n    <span>是否确认删除该私信？</span>\n    <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button @click=\"dialogFormVisibleForDelete = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"conformDelete()\">确定</el-button>\n      </span>\n    </template>\n  </el-dialog>\n  <!--标记已读弹窗-->\n  <el-dialog v-model=\"dialogFormVisibleForRead\" title=\"标记已读\">\n    <span>是否确认标记该私信已读？</span>\n    <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button @click=\"dialogFormVisibleForRead = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"conformRead()\">确定</el-button>\n      </span>\n    </template>\n  </el-dialog>\n  <!--查看私信-->\n  <el-dialog v-model=\"dialogFormVisibleForLook\" title=\"查看私信\">\n    <div id=\"content\"></div>\n    <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button type=\"primary\" @click=\"dialogFormVisibleForLook=false\">关闭</el-button>\n      </span>\n    </template>\n  </el-dialog>\n\n</template>\n\n<script>\nimport request from \"../../utils/request\";\nimport {ElMessage} from \"element-plus\";\nimport moment from 'moment';\nimport $ from '../../assets/js/jquery-3.6.0';\nlet userEmail;\nlet messageId;\n\nexport default {\n  name: \"MyMessageOfNotRead\",\n  data() {\n    return {\n      tableData: [\n\n      ],\n      total: 0,\n      pageSize: 5,\n      currentPage: 1,\n      dialogFormVisibleForLook: false,\n      dialogFormVisibleForDelete: false,\n      dialogFormVisibleForRead: false\n    }\n  },\n  created() {\n    this.loadData()\n  },\n  methods: {\n    //格式化日期\n    timeFilter(row, column, cellValue, index) {\n      const date = row[column.property]\n      if(date !=null){\n        return moment(date).format(\"YYYY-MM-DD\")\n      }\n    },\n    //当前页码改变\n    handleCurrentChange() {\n      this.loadData()\n    },\n    //加载数据\n    loadData() {\n      let email = sessionStorage.getItem(\"userEmail\")\n      let reg = new RegExp('\"', \"g\");\n      userEmail = email.replace(reg, \"\");    //正则表达式，将字符串两端的双引号去掉\n      request.get(\"/message_User/getAllNotRead\",{\n        params: {\n          userEmail: userEmail,\n          currentPage: this.currentPage,\n          pageSize: this.pageSize\n        }\n      }).then(res => {\n        this.tableData = res.data.records\n        this.total = res.data.total\n      })\n    },\n    //查看详情\n    look(content) {\n      this.dialogFormVisibleForLook = true\n      this.$nextTick(() => {\n        $('#content').html(content)\n      })\n    },\n    //删除\n    delete(id) {\n      messageId = id\n      this.dialogFormVisibleForDelete = true\n    },\n    //确认删除\n    conformDelete() {\n      request.post(\"/message/deleteMessage\",messageId).then(res =>{\n        ElMessage({\n          type: 'success',\n          message: '删除成功'\n        })\n        this.loadData()\n        this.dialogFormVisibleForDelete = false\n      })\n    },\n    //标记已读\n    read(id) {\n      messageId = id\n      this.dialogFormVisibleForRead = true\n    },\n    //确认标记\n    conformRead() {\n      request.post(\"/message/setMessageReaded\",messageId).then(res =>{\n        this.loadData()\n        this.dialogFormVisibleForRead = false\n        ElMessage({\n          type: 'success',\n          message: '标记成功'\n        })\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.dF{\n  width: 90%;position: absolute;left: 5%;right: 5%;margin-top: 50px;\n}\n.el1{\n  width: 100%;\n}\n.el2{\n  margin-top: 15px;\n}\n</style>"]},"metadata":{},"sourceType":"module"}