{"ast":null,"code":"import moment from \"moment\";\nimport request from \"../../utils/request\";\nimport $ from '../../assets/js/jquery-3.6.0';\nimport { ElMessage } from \"element-plus\";\nlet userEmail;\nlet commentId;\nexport default {\n  name: \"MyComment\",\n\n  data() {\n    return {\n      tableData: [],\n      total: 0,\n      currentPage: 1,\n      pageSize: 5,\n      dialogFormVisibleForDelete: false,\n      dialogFormVisibleForLook: false\n    };\n  },\n\n  methods: {\n    //格式化日期\n    timeFilter(row, column, cellValue, index) {\n      const date = row[column.property];\n\n      if (date != null) {\n        return moment(date).format(\"YYYY-MM-DD\");\n      }\n    },\n\n    //加载数据\n    loadData() {\n      let email = sessionStorage.getItem(\"userEmail\");\n      let reg = new RegExp('\"', \"g\");\n      userEmail = email.replace(reg, \"\"); //正则表达式，将字符串两端的双引号去掉\n\n      request.get(\"/comment_News/get\", {\n        params: {\n          userEmail: userEmail,\n          currentPage: this.currentPage,\n          pageSize: this.pageSize\n        }\n      }).then(res => {\n        this.tableData = res.data.records;\n        this.total = res.data.total;\n      });\n    },\n\n    //查看评论\n    look(content) {\n      this.dialogFormVisibleForLook = true;\n      this.$nextTick(() => {\n        $('#content').html(content);\n      });\n    },\n\n    //删除评论\n    delete(id) {\n      this.dialogFormVisibleForDelete = true;\n      commentId = id;\n    },\n\n    //确认删除\n    conformDelete() {\n      request.post(\"/comment/deleteCommentById\", commentId).then(res => {\n        this.loadData();\n        this.dialogFormVisibleForDelete = false;\n        ElMessage({\n          type: 'success',\n          message: '删除成功'\n        });\n      });\n    },\n\n    //当页码改变时\n    handleCurrentChange() {\n      this.loadData();\n    }\n\n  },\n\n  created() {\n    this.loadData();\n  }\n\n};","map":{"version":3,"mappings":"AA+CA,OAAOA,MAAP,MAAmB,QAAnB;AACA,OAAOC,OAAP,MAAoB,qBAApB;AACA,OAAOC,CAAP,MAAc,8BAAd;AACA,SAAQC,SAAR,QAAwB,cAAxB;AACA,IAAIC,SAAJ;AACA,IAAIC,SAAJ;AAEA,eAAe;EACbC,IAAI,EAAE,WADO;;EAEbC,IAAI,GAAG;IACL,OAAO;MACLC,SAAS,EAAE,EADN;MAILC,KAAK,EAAE,CAJF;MAKLC,WAAW,EAAE,CALR;MAMLC,QAAQ,EAAE,CANL;MAOLC,0BAA0B,EAAE,KAPvB;MAQLC,wBAAwB,EAAE;IARrB,CAAP;EAUD,CAbY;;EAcbC,OAAO,EAAE;IACP;IACAC,UAAU,CAACC,GAAD,EAAMC,MAAN,EAAcC,SAAd,EAAyBC,KAAzB,EAAgC;MACxC,MAAMC,IAAG,GAAIJ,GAAG,CAACC,MAAM,CAACI,QAAR,CAAhB;;MACA,IAAGD,IAAG,IAAI,IAAV,EAAe;QACb,OAAOpB,MAAM,CAACoB,IAAD,CAAN,CAAaE,MAAb,CAAoB,YAApB,CAAP;MACF;IACD,CAPM;;IAQP;IACAC,QAAQ,GAAG;MACT,IAAIC,KAAI,GAAIC,cAAc,CAACC,OAAf,CAAuB,WAAvB,CAAZ;MACA,IAAIC,GAAE,GAAI,IAAIC,MAAJ,CAAW,GAAX,EAAgB,GAAhB,CAAV;MACAxB,SAAQ,GAAIoB,KAAK,CAACK,OAAN,CAAcF,GAAd,EAAmB,EAAnB,CAAZ,CAHS,CAG8B;;MACvC1B,OAAO,CAAC6B,GAAR,CAAY,mBAAZ,EAAgC;QAC9BC,MAAM,EAAE;UACN3B,SAAS,EAAEA,SADL;UAENM,WAAW,EAAE,KAAKA,WAFZ;UAGNC,QAAQ,EAAE,KAAKA;QAHT;MADsB,CAAhC,EAMGqB,IANH,CAMQC,GAAE,IAAI;QACZ,KAAKzB,SAAL,GAAiByB,GAAG,CAAC1B,IAAJ,CAAS2B,OAA1B;QACA,KAAKzB,KAAL,GAAawB,GAAG,CAAC1B,IAAJ,CAASE,KAAtB;MACD,CATD;IAUD,CAvBM;;IAwBP;IACA0B,IAAI,CAACC,OAAD,EAAU;MACZ,KAAKvB,wBAAL,GAAgC,IAAhC;MACA,KAAKwB,SAAL,CAAe,MAAM;QACnBnC,CAAC,CAAC,UAAD,CAAD,CAAcoC,IAAd,CAAmBF,OAAnB;MACD,CAFD;IAGD,CA9BM;;IA+BP;IACAG,MAAM,CAACC,EAAD,EAAK;MACT,KAAK5B,0BAAL,GAAkC,IAAlC;MACAP,SAAQ,GAAImC,EAAZ;IACD,CAnCM;;IAoCP;IACAC,aAAa,GAAG;MACdxC,OAAO,CAACyC,IAAR,CAAa,4BAAb,EAA0CrC,SAA1C,EAAqD2B,IAArD,CAA0DC,GAAE,IAAI;QAC9D,KAAKV,QAAL;QACA,KAAKX,0BAAL,GAAkC,KAAlC;QACAT,SAAS,CAAC;UACRwC,IAAI,EAAE,SADE;UAERC,OAAO,EAAE;QAFD,CAAD,CAAT;MAID,CAPD;IAQD,CA9CM;;IA+CP;IACAC,mBAAmB,GAAG;MACpB,KAAKtB,QAAL;IACF;;EAlDO,CAdI;;EAkEbuB,OAAO,GAAG;IACR,KAAKvB,QAAL;EACF;;AApEa,CAAf","names":["moment","request","$","ElMessage","userEmail","commentId","name","data","tableData","total","currentPage","pageSize","dialogFormVisibleForDelete","dialogFormVisibleForLook","methods","timeFilter","row","column","cellValue","index","date","property","format","loadData","email","sessionStorage","getItem","reg","RegExp","replace","get","params","then","res","records","look","content","$nextTick","html","delete","id","conformDelete","post","type","message","handleCurrentChange","created"],"sourceRoot":"","sources":["/Users/wangjin/Desktop/newspublisher/Vue/src/views/user/MyComment.vue"],"sourcesContent":["<template>\n  <div class=\"dF\">\n    <el-table :data=\"tableData\" border class=\"el1\">\n      <el-table-column prop=\"headline\" label=\"新闻标题\" width=\"\" align=\"center\" />\n      <el-table-column prop=\"date\" label=\"评论日期\" width=\"100\" align=\"center\" :formatter=\"timeFilter\"/>\n      <el-table-column label=\"操作\" width=\"220\" align=\"center\" key=\"slot\">\n        <!--此处使用了插槽，来实现获得某行的对象-->\n        <template #default=\"scope\" >\n          <el-button type=\"text\" size=\"big\" @click=\"this.$router.push({path: '/newsContent',query: {newsId: scope.row.newsId}})\">查看新闻</el-button>\n          <el-button type=\"text\" size=\"big\" @click=\"this.look(scope.row.content)\">查看评论</el-button>\n          <el-button type=\"text\" size=\"big\" @click=\"this.delete(scope.row.id)\">删除评论</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    <!--分页组件-->\n    <el-pagination\n        background\n        layout=\"total, prev, pager, next\"\n        :total=\"total\"\n        :page-size=\"pageSize\"\n        v-model:currentPage=\"currentPage\"\n        @current-change=\"handleCurrentChange\"\n        class=\"el2\">\n    </el-pagination>\n  </div>\n  <!--删除评论弹窗，点击删除时才显示-->\n  <el-dialog v-model=\"dialogFormVisibleForDelete\" title=\"删除评论\">\n    <span>是否确认删除该评论？</span>\n    <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button @click=\"dialogFormVisibleForDelete = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"conformDelete()\">确定</el-button>\n      </span>\n    </template>\n  </el-dialog>\n  <!--查看评论弹窗，点击查看时才显示-->\n  <el-dialog v-model=\"dialogFormVisibleForLook\" title=\"查看评论\">\n    <div id=\"content\"></div>\n    <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button type=\"primary\" @click=\"dialogFormVisibleForLook=false\">关闭</el-button>\n      </span>\n    </template>\n  </el-dialog>\n</template>\n\n<script>\nimport moment from \"moment\";\nimport request from \"../../utils/request\";\nimport $ from '../../assets/js/jquery-3.6.0';\nimport {ElMessage} from \"element-plus\";\nlet userEmail;\nlet commentId;\n\nexport default {\n  name: \"MyComment\",\n  data() {\n    return {\n      tableData: [\n\n      ],\n      total: 0,\n      currentPage: 1,\n      pageSize: 5,\n      dialogFormVisibleForDelete: false,\n      dialogFormVisibleForLook: false\n    }\n  },\n  methods: {\n    //格式化日期\n    timeFilter(row, column, cellValue, index) {\n      const date = row[column.property]\n      if(date !=null){\n        return moment(date).format(\"YYYY-MM-DD\")\n      }\n    },\n    //加载数据\n    loadData() {\n      let email = sessionStorage.getItem(\"userEmail\")\n      let reg = new RegExp('\"', \"g\");\n      userEmail = email.replace(reg, \"\");    //正则表达式，将字符串两端的双引号去掉\n      request.get(\"/comment_News/get\",{\n        params: {\n          userEmail: userEmail,\n          currentPage: this.currentPage,\n          pageSize: this.pageSize\n        }\n      }).then(res =>{\n        this.tableData = res.data.records;\n        this.total = res.data.total\n      })\n    },\n    //查看评论\n    look(content) {\n      this.dialogFormVisibleForLook = true\n      this.$nextTick(() => {\n        $('#content').html(content)\n      })\n    },\n    //删除评论\n    delete(id) {\n      this.dialogFormVisibleForDelete = true\n      commentId = id\n    },\n    //确认删除\n    conformDelete() {\n      request.post(\"/comment/deleteCommentById\",commentId).then(res =>{\n        this.loadData()\n        this.dialogFormVisibleForDelete = false\n        ElMessage({\n          type: 'success',\n          message: '删除成功'\n        })\n      })\n    },\n    //当页码改变时\n    handleCurrentChange() {\n      this.loadData()\n    }\n  },\n  created() {\n    this.loadData()\n  }\n}\n</script>\n\n<style scoped>\n.dF{\n  width: 90%;position: absolute;left: 5%;right: 5%;margin-top: 50px;\n}\n.el1{\n  width: 100%;\n}\n.el2{\n  margin-top: 15px;\n}\n</style>"]},"metadata":{},"sourceType":"module"}